<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Parking</title>
  <meta name="description" content="Enter details and continue securely to payment. We do not store your data." />
  <style>
    :root{
      --bg:#0b1020; --panel:#121726; --text:#eaf1ee;
      --muted:#9ec1ac; --line:#1f2f27; --accent:#1db954; /* verde */
      --accent-contrast:#0a2718;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,Segoe UI,Roboto,Arial;background:var(--bg);color:var(--text)}
    .bar{background:var(--accent); color:#fff; padding:18px 20px; display:flex; align-items:center; justify-content:center; font-weight:800; font-size:22px; letter-spacing:.2px; border-bottom:2px solid var(--accent-contrast)}
    .wrap{max-width:860px; margin:22px auto; padding:0 16px}
    .card{background:var(--panel); border:1px solid var(--line); border-radius:20px; padding:20px; box-shadow:0 10px 28px rgba(0,0,0,.35)}
    p.hint{margin:10px 0 18px; color:var(--muted)}
    label{display:block; margin:14px 0 6px; font-weight:600}
    input{width:100%; background:#0f1424; border:1px solid var(--line); color:var(--text); padding:14px; border-radius:12px; outline:none}
    input::placeholder{color:#7a8c86}
    .row{display:grid; gap:12px; grid-template-columns:1fr}
    .btn{display:inline-block; width:100%; text-align:center; border-radius:14px; padding:16px 18px; font-weight:800; cursor:pointer; border:0; background:var(--accent); color:#fff}
    .btn:hover{filter:brightness(1.05)}
    .note{font-size:13px; color:#a6c2b3; margin-top:10px}
    .badge{font-size:12px; color:#7ad39c; background:#064f2b; border-radius:999px; padding:4px 10px}
    @media (max-width:700px){ .row{grid-template-columns:1fr} }
    .error{color:#ffb4b4; font-size:13px; margin-top:6px; display:none}
  </style>
</head>
<body>
  <div class="bar">Parking</div>

  <div class="wrap">
    <div class="card">
      <div class="top">
        <span class="badge">qrtap.org</span>
      </div>

      <p class="hint">
        Fill in your details, then press <b>Next</b>. You’ll be redirected to a secure Stripe checkout.
        We do not process or store card data.
      </p>

      <form id="f" autocomplete="on">
        <label for="plate">Car plate number</label>
        <input id="plate" name="plate" placeholder="e.g. AB12 CDE" required />

        <label for="loc">Parking location (code or name)</label>
        <input id="loc" name="loc" placeholder="e.g. RingGo code or address" required />

        <label for="dur">Duration (hours)</label>
        <input id="dur" name="dur" inputmode="numeric" pattern="[0-9]{1,3}" placeholder="e.g. 2" required />
        <div id="err" class="error">Please enter a duration between 1 and 999 hours.</div>

        <div style="margin:18px 0 6px"></div>
        <button type="submit" class="btn">Next →</button>

        <p class="note">
          Price is calculated at checkout. Payment happens on Stripe’s secure page.
        </p>
      </form>
    </div>
  </div>

  <script>
    // 1) UPDATE THIS to your real backend endpoint that creates a Stripe Checkout Session.
    //    Example if you use Netlify Functions: "/.netlify/functions/create-checkout-session"
    const STRIPE_SESSION_ENDPOINT = "/.netlify/functions/create-checkout-session";

    const form = document.getElementById('f');
    const err  = document.getElementById('err');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const plate = document.getElementById('plate').value.trim();
      const loc   = document.getElementById('loc').value.trim();
      const dur   = document.getElementById('dur').value.trim();

      // Simple validation for duration 1..999
      if(!/^[0-9]{1,3}$/.test(dur) || Number(dur) < 1){
        err.style.display = 'on';
        return;
      }
      err.style.display = 'none';

      // Optional: keep values for the next page (in case you need them later)
      try {
        localStorage.setItem('qp_plate', plate);
        localStorage.setItem('qp_loc', loc);
        localStorage.setItem('qp_dur', dur);
      } catch(_) {}

      // Redirect to your backend which creates a Stripe Checkout Session,
      // then redirects to Stripe. Common approach:
      //  - Backend reads ?plate=&loc=&dur=
      //  - Creates a Checkout Session with Stripe SDK
      //  - Responds with 303 redirect to session.url
      const params = new URLSearchParams({ plate, loc, dur }).toString();
      window.location.href = `${STRIPE_SESSION_ENDPOINT}?${params}`;
    });
  </script>
</body>
</html>
